# Как работает программа

## Общая архитектура

Программа состоит из двух основных частей:
1. **Backend** - Node.js с Puppeteer для автоматизации браузера
2. **Frontend** - Next.js интерфейс для управления процессом

## Этапы работы программы

### 1. Фаза авторизации (5 минут)
- Открывается браузер с возможностью ручной авторизации
- Пользователь входит в аккаунт hh.ru вручную
- Система автоматически извлекает токены авторизации
- Токены сохраняются для будущих запусков

### 2. Фаза парсинга (Parsing Phase)
```
Начало → Авторизация → Парсинг вакансий → Фильтрация → Сохранение в БД
```

**Подробный процесс:**
1. Запуск браузера с куками пользователя
2. Переход на страницы поиска вакансий на hh.ru
3. Сбор вакансий по заданным критериям (до указанного в UI количества)
4. Фильтрация по стоп-словам и релевантности
5. Сохранение в SQLite базу данных

**Ключевые особенности:**
- Должно собираться ровно столько вакансий, сколько указано в UI
- Парсинг должен быть быстрым (несколько минут максимум)
- Интерфейс должен показывать реальный прогресс

### 3. Фаза рейтинга (Rating Phase)
```
Загрузка вакансий → Анализ релевантности → Сортировка → Выбор топ-400
```

**Процесс:**
1. Загрузка описаний вакансий
2. Анализ через Google Gemini AI
3. Расчет коэффициента релевантности
4. Сортировка по убыванию релевантности
5. Выбор топ-400 самых подходящих вакансий

### 4. Фаза отклика (Applying Phase)
```
Открытие вакансии → Поиск кнопки отклика → Отправка отклика → Сохранение статуса
```

**Процесс:**
1. Последовательное открытие вакансий из топ-400
2. Поиск и нажатие кнопки "Откликнуться"
3. Обработка модальных окон (если есть)
4. Подтверждение отправки отклика
5. Сохранение статуса в базе данных

## Конфигурация

### Количество вакансий
- Задается в UI перед запуском
- По умолчанию: 1000 вакансий
- Можно выбрать: 50, 300, 700, 1000, 2000

### Поисковые запросы
Настроены в `backend/src/config/index.js`:
- React, React разработчик
- Frontend, Frontend разработчик
- Next.js, TypeScript
- И другие ключевые запросы

### Фильтры
- Стоп-слова для исключения нерелевантных вакансий
- Релевантность рассчитывается по алгоритму

## Особенности работы

1. **Автоматическая авторизация** - токены извлекаются автоматически после ручного входа
2. **Сохранение прогресса** - данные не теряются между запусками
3. **Обработка ошибок** - повторные попытки при сетевых сбоях
4. **Интерфейс в реальном времени** - прогресс отображается моментально

## Требования к производительности

- **Парсинг**: 500-2000 вакансий за 2-5 минут
- **Рейтинг**: анализ топ-400 вакансий за 1-2 минуты
- **Отклик**: 20 откликов за 3-5 минут
- **Общий цикл**: полный процесс не более 10 минут

## Статусы выполнения

1. **idle** - Готов к запуску
2. **waiting_for_auth** - Ожидание авторизации (5 мин)
3. **parsing** - Парсинг вакансий
4. **rating** - Рейтинг вакансий
5. **applying** - Отправка откликов
6. **completed** - Завершено
7. **error** - Ошибка

## Файлы и директории

```
autoclick3.2/
├── backend/
│   ├── src/
│   │   ├── parser/          # Парсинг вакансий
│   │   ├── applicator/      # Отправка откликов
│   │   ├── config/          # Конфигурация
│   │   ├── db/              # База данных
│   │   ├── services/        # Сервисы (AI, фильтрация)
│   │   └── main.js          # Главный файл
│   └── package.json
├── frontend/
│   ├── src/
│   │   ├── components/      # Компоненты UI
│   │   ├── app/api/         # API маршруты
│   │   └── lib/             # Библиотеки
│   └── package.json
└── README.md
```