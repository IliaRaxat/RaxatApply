# Requirements Document: Fix HH.ru Application System

## Introduction

Система автоматизации откликов на вакансии HH.ru не отправляет отклики успешно. Парсинг вакансий работает корректно, но при попытке отправить отклик система получает ошибки. Необходимо исправить механизм отправки откликов, чтобы система могла успешно откликаться на вакансии.

## Glossary

- **HH.ru** - HeadHunter, российский сайт по поиску работы
- **Resume ID** - уникальный идентификатор резюме пользователя на HH.ru
- **HHTOKEN** - токен авторизации пользователя на HH.ru
- **XSRF** - токен защиты от CSRF атак
- **HTTP Client** - клиент для отправки HTTP запросов к API HH.ru
- **Applicator** - модуль системы, отвечающий за отправку откликов

## Requirements

### Requirement 1

**User Story:** Как пользователь системы, я хочу чтобы система получала список моих резюме с HH.ru, чтобы использовать правильные ID резюме при откликах

#### Acceptance Criteria

1. WHEN система инициализируется с токенами пользователя, THE HTTP Client SHALL получить список резюме пользователя через API HH.ru
2. WHEN список резюме получен, THE System SHALL извлечь ID первого активного резюме
3. IF список резюме пуст, THEN THE System SHALL вернуть ошибку с понятным сообщением
4. WHEN резюме получено, THE System SHALL сохранить его ID для использования в откликах

### Requirement 2

**User Story:** Как пользователь системы, я хочу чтобы система использовала правильный ID резюме при отправке откликов, чтобы отклики успешно отправлялись

#### Acceptance Criteria

1. WHEN система отправляет отклик на вакансию, THE Applicator SHALL использовать ID резюме вместо токена
2. WHEN отклик отправляется, THE System SHALL использовать правильный HTTP endpoint для отправки откликов
3. IF отклик успешно отправлен, THEN THE System SHALL обновить статус вакансии на 'applied'
4. IF отклик не удалось отправить, THEN THE System SHALL логировать причину ошибки

### Requirement 3

**User Story:** Как пользователь системы, я хочу видеть понятные сообщения об ошибках, чтобы понимать почему отклики не отправляются

#### Acceptance Criteria

1. WHEN происходит ошибка при получении резюме, THE System SHALL вывести сообщение с описанием проблемы
2. WHEN происходит ошибка при отправке отклика, THE System SHALL вывести сообщение с кодом ошибки и описанием
3. WHEN отклик успешно отправлен, THE System SHALL вывести сообщение с названием вакансии
4. WHEN достигнут лимит откликов, THE System SHALL вывести сообщение о необходимости подождать

### Requirement 4

**User Story:** Как пользователь системы, я хочу чтобы система корректно обрабатывала разные типы ответов от HH.ru, чтобы правильно определять успешность отклика

#### Acceptance Criteria

1. WHEN HH.ru возвращает успешный ответ, THE System SHALL распознать его как успешный отклик
2. WHEN HH.ru возвращает ошибку "уже откликнулись", THE System SHALL обновить статус вакансии на 'already_responded'
3. WHEN HH.ru возвращает ошибку "лимит откликов", THE System SHALL обновить статус вакансии на 'rate_limited'
4. WHEN HH.ru возвращает другую ошибку, THE System SHALL обновить статус вакансии на 'failed_application'
